{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Agent RL Model Deployed",
  "description": "Notification when new RL-trained model is deployed to serving",
  "type": "object",
  "required": [
    "deployment_id",
    "training_job_id",
    "timestamp",
    "model_info",
    "deployment_config",
    "validation_results"
  ],
  "properties": {
    "deployment_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for this deployment"
    },
    "training_job_id": {
      "type": "string",
      "format": "uuid",
      "description": "Reference to source training job"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Deployment timestamp (ISO 8601)"
    },
    "model_info": {
      "type": "object",
      "required": ["model_id", "base_model", "checkpoint_path"],
      "properties": {
        "model_id": {
          "type": "string",
          "description": "Unique model identifier",
          "examples": ["agent-zero-rl-v2.3"]
        },
        "base_model": {
          "type": "string",
          "description": "Base model that was fine-tuned",
          "examples": ["qwen2.5-32b-instruct"]
        },
        "checkpoint_path": {
          "type": "string",
          "description": "S3/MinIO path to deployed checkpoint"
        },
        "training_date": {
          "type": "string",
          "format": "date-time",
          "description": "When model was trained"
        },
        "training_samples": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of trajectories used in training"
        },
        "final_reward": {
          "type": "number",
          "description": "Final training reward metric"
        }
      }
    },
    "deployment_config": {
      "type": "object",
      "required": ["serving_platform", "endpoint", "model_name", "rollout_strategy"],
      "properties": {
        "serving_platform": {
          "type": "string",
          "enum": ["tensorzero", "vllm", "tgi", "ollama"],
          "description": "Model serving platform"
        },
        "endpoint": {
          "type": "string",
          "format": "uri",
          "description": "Serving endpoint URL"
        },
        "model_name": {
          "type": "string",
          "description": "Model name in serving platform"
        },
        "rollout_strategy": {
          "type": "string",
          "enum": ["canary", "blue_green", "immediate"],
          "description": "Deployment rollout strategy"
        },
        "traffic_percentage": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Initial traffic percentage"
        },
        "ramp_schedule": {
          "type": "array",
          "description": "Traffic ramp schedule for canary deployment",
          "items": {
            "type": "object",
            "required": ["timestamp", "percentage"],
            "properties": {
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "When to ramp to this percentage"
              },
              "percentage": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "description": "Target traffic percentage"
              }
            }
          }
        }
      }
    },
    "validation_results": {
      "type": "object",
      "required": ["benchmark_passed", "safety_checks_passed", "performance_regression"],
      "properties": {
        "benchmark_passed": {
          "type": "boolean",
          "description": "Whether model passed benchmark suite"
        },
        "safety_checks_passed": {
          "type": "boolean",
          "description": "Whether model passed safety validation"
        },
        "performance_regression": {
          "type": "boolean",
          "description": "Whether model shows performance regression vs current"
        },
        "human_eval_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Human evaluation score if conducted"
        },
        "benchmark_scores": {
          "type": "object",
          "description": "Detailed benchmark scores",
          "additionalProperties": {
            "type": "number"
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "deployed_by": {
          "type": "string",
          "description": "Entity that deployed the model",
          "examples": ["rl-trainer-subordinate", "admin-user"]
        },
        "approval_status": {
          "type": "string",
          "enum": ["automated", "manual_approved", "emergency_override"],
          "description": "Deployment approval type"
        },
        "previous_model": {
          "type": "string",
          "description": "Model ID of previous deployed model"
        }
      }
    }
  },
  "additionalProperties": false
}
