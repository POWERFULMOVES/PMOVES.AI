apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Pull in base manifests
resources:
  - ../base

# Override image tag / registry for the AI lab cluster
images:
  - name: ghcr.io/powerfulmoves/pmoves-core
    newName: ghcr.io/powerfulmoves/pmoves-core
    newTag: "v1.0.0-lab-hardened"

# Optional patches specific to the lab (more replicas, different host, etc.)
patches:
  - target:
      kind: Ingress
      name: pmoves-core
    patch: |
      - op: replace
        path: /spec/rules/0/host
        value: pmoves.lab.local
  - target:
      kind: Deployment
      name: pmoves-core
    patch: |
      - op: replace
        path: /spec/replicas
        value: 5
